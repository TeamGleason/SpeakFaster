<style>

:host {
  background-color: black;
  box-sizing: border-box;
  color: #333;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  font-size: 16px;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

app-abbreviation-component {
  display: block;
}

app-context-component {
  display: block;
}

app-text-to-speech-component {
  float: right;
}

.auth-area {
  border: 2px solid yellow;
  border-radius: 7px;
  padding: 10px;
}

.content {
  box-sizing: border-box;
  height: fit-content;
  margin: 0;
  width: fit-content;
  /* TODO(cais): Add max-width and max-height. */
}

.bottom-area {
  position: absolute;
  top: 100%;
  transform: translateY(-100%);
}

.main-area {
  overflow: hidden;
  position: relative;
  width: 1140px;
  height: 380px;
}

</style>

<div #contentWrapper class="content" role="main">

  <!-- This is a "virtual" component without any UI. It is purely for
       handling keyboard events. -->
  <app-keyboard-component></app-keyboard-component>

  <div *ngIf="!hasAccessToken()" class="auth-area">
    <app-auth-component (newAccessToken)="onNewAccessToken($event)"></app-auth-component>
  </div>

  <app-external-events-component
      #externalEvents
      [textEntryBeginSubject]="textEntryBeginSubject"
      [textEntryEndSubject]="textEntryEndSubject">
  </app-external-events-component>

  <app-text-to-speech-component
      [textEntryEndSubject]="textEntryEndSubject"
      [accessToken]="accessToken">
  </app-text-to-speech-component>

  <div class="minimized-area" *ngIf="hasAccessToken()">
    <app-mini-bar-component
      [appState]="appState"
      (appStateChanged)="onAppStateChanged($event)">
    </app-mini-bar-component>
  </div>

  <div
      class="main-area"
      *ngIf="hasAccessToken() && appState === 'EXPANDED'">
    <app-metrics-component
        [textEntryBeginSubject]="textEntryBeginSubject"
        [textEntryEndSubject]="textEntryEndSubject">
    </app-metrics-component>

    <app-context-component
      [textEntryEndSubject]="textEntryEndSubject"
      (contextStringsSelected)="onContextStringsSelected($event)"
    ></app-context-component>

    <app-abbreviation-component
      [contextStrings]="contextStrings"
      [abbreviationExpansionTriggers]="abbreviationExpansionTriggers"
      [textEntryEndSubject]="textEntryEndSubject"
    ></app-abbreviation-component>

    <div class="bottom-area">
      <app-abbreviation-editing-component
        [textEntryBeginSubject]="textEntryBeginSubject"
        [textInjectionSubject]="textEntryEndSubject"
        (inputAbbreviationChanged)="onAbbreviationInputChanged($event)"
        (spellingStateChanged)="onSpellingStateChanged($event)"
      ></app-abbreviation-editing-component>

      <app-text-prediction-component
        [contextStrings]="contextStrings"
        [textPrefix]=(inputAbbreviation)
        [textInjectionSubject]="textEntryEndSubject"
      ></app-text-prediction-component>
    </div>

  </div>


</div>

<router-outlet></router-outlet>
